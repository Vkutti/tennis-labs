<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="/static/index.css"/>
  <title>TennisLab</title>
  <link rel="icon" type="image/svg+xml" href="../static/tennislablogosvg.svg">
  <link rel="icon" type="image/png" href="../static/tennislablogo.png">

</head>
  <body>
    <div class="title">
      <h1>TennisLab</h1>
    </div>

    <form action="/simulate" method="post">
      <div class="versus">
        <select name="tennis_players_a" id="tennis_players_a">
          <option value="empty">Select a player</option>
          <option value="Roger Federer">Roger Federer</option>
          <option value="Novak Djokovic">Novak Djokovic</option>
          <option value="Rafael Nadal">Rafael Nadal</option>
          <option value="Andy Murray">Andy Murray</option>
          <option value="Andy Roddick">Andy Roddick</option>
          <option value="Stan Wawrinka">Stan Wawrinka</option>
          <option value="Lleyton Hewitt">Lleyton Hewitt</option>
          <option value="Gilles Simon">Gilles Simon</option>
          <option value="Marat Safin">Marat Safin</option>
          <option value="Juan Martin del Potro">Juan Martin del Potro</option>
          <option value="Marin Cilic">Marin Cilic</option>
          <option value="Alexander Zverev">Alexander Zverev</option>
          <option value="Grigor Dimitrov">Grigor Dimitrov</option>
          <option value="David Ferrer">David Ferrer</option>
          <option value="Nick Kyrgios">Nick Kyrgios</option>
          <option value="Daniil Medvedev">Daniil Medvedev</option>
          <option value="Jannik Sinner">Jannik Sinner</option>
          <option value="Frances Tiafoe">Frances Tiafoe</option>
          <option value="Carlos Alcaraz">Carlos Alcaraz</option>
        </select>

        <h1>VS</h1>

        <select name="tennis_players_b" id="tennis_players_b">
          <option value="empty">Select a player</option>
          <option value="Roger Federer">Roger Federer</option>
          <option value="Novak Djokovic">Novak Djokovic</option>
          <option value="Rafael Nadal">Rafael Nadal</option>
          <option value="Andy Murray">Andy Murray</option>
          <option value="Andy Roddick">Andy Roddick</option>
          <option value="Stan Wawrinka">Stan Wawrinka</option>
          <option value="Lleyton Hewitt">Lleyton Hewitt</option>
          <option value="Gilles Simon">Gilles Simon</option>
          <option value="Marat Safin">Marat Safin</option>
          <option value="Juan Martin del Potro">Juan Martin del Potro</option>
          <option value="Marin Cilic">Marin Cilic</option>
          <option value="Alexander Zverev">Alexander Zverev</option>
          <option value="Grigor Dimitrov">Grigor Dimitrov</option>
          <option value="David Ferrer">David Ferrer</option>
          <option value="Nick Kyrgios">Nick Kyrgios</option>
          <option value="Daniil Medvedev">Daniil Medvedev</option>
          <option value="Jannik Sinner">Jannik Sinner</option>
          <option value="Frances Tiafoe">Frances Tiafoe</option>
          <option value="Carlos Alcaraz">Carlos Alcaraz</option>
        </select>
      </div>

      <button type="submit">Simulate Match</button>

    </form>

    <h1>Winner of the match is {{ winner }}</h1>

    <div class="scoreboard">
      <div class="header">Centre Court</div>
      <div class="subheader">Gentlemen's Singles</div>

      <div class="player {% if winner == player_a %} winner {% endif %}">
        <div class="info">
          <div class="name">{{ player_a }}</div>
        </div>
        <div class="sets">
          <div>{{ score_1a }}</div>
          <div>{{ score_2a }}</div>
          <div>{{ score_3a }}</div>
          <div>{{ score_4a }}</div>
          <div>{{ score_5a }}</div>
        </div>
      </div>

      <div class="player {% if winner == player_b %} winner {% endif %}">
        <div class="info">
          <div class="name">{{ player_b }}</div>
        </div>
        <div class="sets">
          <div>{{ score_1b }}</div>
          <div>{{ score_2b }}</div>
          <div>{{ score_3b }}</div>
          <div>{{ score_4b }}</div>
          <div>{{ score_5b }}</div>
        </div>
      </div>
    </div>

    <script>
      function animateMatch() {
        const players = document.querySelectorAll(".player");
        const playerA = players[0].querySelectorAll(".sets div");
        const playerB = players[1].querySelectorAll(".sets div");

        playerA.forEach((scoreA, i) => {
          const scoreB = playerB[i];
          if (!scoreA || !scoreB) return;

          setTimeout(() => {
            scoreA.style.opacity = 1;
            scoreB.style.opacity = 1;

            const valA = parseInt(scoreA.innerText) || 0;
            const valB = parseInt(scoreB.innerText) || 0;

            if (valA > valB) {
              scoreA.classList.add("winner-set");
              scoreB.classList.remove("winner-set");
            } else if (valB > valA) {
              scoreB.classList.add("winner-set");
              scoreA.classList.remove("winner-set");
            } else {
              scoreA.classList.remove("winner-set");
              scoreB.classList.remove("winner-set");
            }
          }, i * 1000);
        });

        setTimeout(() => {
          const finalWinner = document.querySelector(".player.winner");
          if (finalWinner) {
            finalWinner.classList.add("final-highlight");
          }
        }, playerA.length * 1000);
      }

      window.onload = animateMatch;
    </script>
    
  </body>
</html>
